<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Read the contents of a worksheet into an R data.frame. — read.xlsx • xlsx</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Read the contents of a worksheet into an R data.frame. — read.xlsx"><meta property="og:description" content="The read.xlsx function provides a high level API for reading data
from an Excel worksheet.  It calls several low level functions in the
process.  Its goal is to provide the conveniency of
read.table by borrowing from its signature."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">xlsx</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.6.5.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/excel_report.html">Build Excel Reports from R</a>
    </li>
  </ul></li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/colearendt/xlsx/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Read the contents of a worksheet into an R <code>data.frame</code>.</h1>
    <small class="dont-index">Source: <a href="https://github.com/colearendt/xlsx/blob/HEAD/R/read.xlsx.R" class="external-link"><code>R/read.xlsx.R</code></a>, <a href="https://github.com/colearendt/xlsx/blob/HEAD/R/read.xlsx2.R" class="external-link"><code>R/read.xlsx2.R</code></a></small>
    <div class="hidden name"><code>read.xlsx.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>The <code>read.xlsx</code> function provides a high level API for reading data
from an Excel worksheet.  It calls several low level functions in the
process.  Its goal is to provide the conveniency of
<code><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.table</a></code> by borrowing from its signature.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="fu">read.xlsx</span><span class="op">(</span>
  <span class="va">file</span>,
  <span class="va">sheetIndex</span>,
  sheetName <span class="op">=</span> <span class="cn">NULL</span>,
  rowIndex <span class="op">=</span> <span class="cn">NULL</span>,
  startRow <span class="op">=</span> <span class="cn">NULL</span>,
  endRow <span class="op">=</span> <span class="cn">NULL</span>,
  colIndex <span class="op">=</span> <span class="cn">NULL</span>,
  as.data.frame <span class="op">=</span> <span class="cn">TRUE</span>,
  header <span class="op">=</span> <span class="cn">TRUE</span>,
  colClasses <span class="op">=</span> <span class="cn">NA</span>,
  keepFormulas <span class="op">=</span> <span class="cn">FALSE</span>,
  encoding <span class="op">=</span> <span class="st">"unknown"</span>,
  password <span class="op">=</span> <span class="cn">NULL</span>,
  <span class="va">...</span>
<span class="op">)</span>

<span class="fu">read.xlsx2</span><span class="op">(</span>
  <span class="va">file</span>,
  <span class="va">sheetIndex</span>,
  sheetName <span class="op">=</span> <span class="cn">NULL</span>,
  startRow <span class="op">=</span> <span class="fl">1</span>,
  colIndex <span class="op">=</span> <span class="cn">NULL</span>,
  endRow <span class="op">=</span> <span class="cn">NULL</span>,
  as.data.frame <span class="op">=</span> <span class="cn">TRUE</span>,
  header <span class="op">=</span> <span class="cn">TRUE</span>,
  colClasses <span class="op">=</span> <span class="st">"character"</span>,
  password <span class="op">=</span> <span class="cn">NULL</span>,
  <span class="va">...</span>
<span class="op">)</span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>file</dt>
<dd><p>the path to the file to read.</p></dd>
<dt>sheetIndex</dt>
<dd><p>a number representing the sheet index in the workbook.</p></dd>
<dt>sheetName</dt>
<dd><p>a character string with the sheet name.</p></dd>
<dt>rowIndex</dt>
<dd><p>a numeric vector indicating the rows you want to extract.
If <code>NULL</code>, all rows found will be extracted, unless <code>startRow</code> or
<code>endRow</code> are specified.</p></dd>
<dt>startRow</dt>
<dd><p>a number specifying the index of starting row.  For
<code>read.xlsx</code> this argument is active only if <code>rowIndex</code> is
<code>NULL</code>.</p></dd>
<dt>endRow</dt>
<dd><p>a number specifying the index of the last row to pull.  If
<code>NULL</code>, read all the rows in the sheet.  For <code>read.xlsx</code> this
argument is active only if <code>rowIndex</code> is <code>NULL</code>.</p></dd>
<dt>colIndex</dt>
<dd><p>a numeric vector indicating the cols you want to extract.
If <code>NULL</code>, all columns found will be extracted.</p></dd>
<dt>as.data.frame</dt>
<dd><p>a logical value indicating if the result should be
coerced into a <code>data.frame</code>.  If <code>FALSE</code>, the result is a list
with one element for each column.</p></dd>
<dt>header</dt>
<dd><p>a logical value indicating whether the first row corresponding
to the first element of the <code>rowIndex</code> vector contains the names of the
variables.</p></dd>
<dt>colClasses</dt>
<dd><p>For <code>read.xlsx</code> a character vector that represent the
class of each column.  Recycled as necessary, or if the character vector is
named, unspecified values are taken to be <code>NA</code>.  For <code>read.xlsx2</code>
see <code><a href="readColumns.html">readColumns</a></code>.</p></dd>
<dt>keepFormulas</dt>
<dd><p>a logical value indicating if Excel formulas should be
shown as text in and not evaluated before bringing them in.</p></dd>
<dt>encoding</dt>
<dd><p>encoding to be assumed for input strings.  See
<code><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.table</a></code>.</p></dd>
<dt>password</dt>
<dd><p>a String with the password.</p></dd>
<dt>...</dt>
<dd><p>other arguments to <code>data.frame</code>, for example
<code>stringsAsFactors</code></p></dd>
</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>A data.frame or a list, depending on the <code>as.data.frame</code>argument.  If some of the columns are read as NA's it's an indication that
the <code>colClasses</code> argument has not been set properly.
If the sheet is empty, return <code>NULL</code>.  If the sheet does not exist,
return an error.</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>The function pulls the value of each non empty cell in the worksheet into a
vector of type <code>list</code> by preserving the data type.  If
<code>as.data.frame=TRUE</code>, this vector of lists is then formatted into a
rectangular shape.  Special care is needed for worksheets with ragged data.</p>
<p>An attempt is made to guess the class type of the variable corresponding to
each column in the worksheet from the type of the first non empty cell in
that column.  If you need to impose a specific class type on a variable, use
the <code>colClasses</code> argument.  It is recommended to specify the column
classes and not rely on <code>R</code> to guess them, unless in very simple cases.</p>
<p>Excel internally stores dates and datetimes as numeric values, and does not
keep track of time zones and DST.  When a datetime column is brought into ,
it is converted to <code>POSIXct</code> class with a <em>GMT</em> timezone.
Occasional rounding errors may appear and the and Excel string
representation my differ by one second.  For <code>read.xlsx2</code> bring in a
datetime column as a numeric one and then convert to class <code>POSIXct</code> or
<code>Date</code>.  Also rounding the <code>POSIXct</code> column in R usually does the
trick too.</p>
<p>The <code>read.xlsx2</code> function does more work in Java so it achieves better
performance (an order of magnitude faster on sheets with 100,000 cells or
more).  The result of <code>read.xlsx2</code> will in general be different from
<code>read.xlsx</code>, because internally <code>read.xlsx2</code> uses
<code>readColumns</code> which is tailored for tabular data.</p>
<p>Reading of password protected workbooks is supported for Excel 2007 OOXML
format only.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="write.xlsx.html">write.xlsx</a></code> for writing <code>xlsx</code> documents.  See
also <code><a href="readColumns.html">readColumns</a></code> for reading only a set of columns into R.</p></div>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Adrian Dragulescu</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"></span>
<span class="r-in"><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="va">file</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"tests"</span>, <span class="st">"test_import.xlsx"</span>, package <span class="op">=</span> <span class="st">"xlsx"</span><span class="op">)</span></span>
<span class="r-in"><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu">read.xlsx</span><span class="op">(</span><span class="va">file</span>, <span class="fl">1</span><span class="op">)</span>  <span class="co"># read first sheet</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span></span>
<span class="r-in"><span class="co">#          NA. Population Income Illiteracy Life.Exp Murder HS.Grad Frost   Area</span></span>
<span class="r-in"><span class="co"># 1    Alabama       3615   3624        2.1    69.05   15.1    41.3    20  50708</span></span>
<span class="r-in"><span class="co"># 2     Alaska        365   6315        1.5    69.31   11.3    66.7   152 566432</span></span>
<span class="r-in"><span class="co"># 3    Arizona       2212   4530        1.8    70.55    7.8    58.1    15 113417</span></span>
<span class="r-in"><span class="co"># 4   Arkansas       2110   3378        1.9    70.66   10.1    39.9    65  51945</span></span>
<span class="r-in"><span class="co"># 5 California      21198   5114        1.1    71.71   10.3    62.6    20 156361</span></span>
<span class="r-in"><span class="co"># 6   Colorado       2541   4884        0.7    72.06    6.8    63.9   166 103766</span></span>
<span class="r-in"><span class="co"># &gt;</span></span>
<span class="r-in"></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># To convert an Excel datetime colum to POSIXct, do something like:</span></span>
<span class="r-in"><span class="co">#   as.POSIXct((x-25569)*86400, tz="GMT", origin="1970-01-01")</span></span>
<span class="r-in"><span class="co"># For Dates, use a conversion like:</span></span>
<span class="r-in"><span class="co">#   as.Date(x-25569, origin="1970-01-01")</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="va">res2</span> <span class="op">&lt;-</span> <span class="fu">read.xlsx2</span><span class="op">(</span><span class="va">file</span>, <span class="fl">1</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="op">}</span></span>
<span class="r-in"></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Adrian Dragulescu, Cole Arendt.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.2.</p>
</div>

      </footer></div>

  


  

  </body></html>

